<!DOCTYPE html>
<head>
<meta charset="utf-8">
<style>

.container {
  border: 1px solid #222222;
}
.tracts path {
  z-index: 1;
}
.tracts path:hover {
  stroke: red;
  stroke-width: 5;
  z-index: 9999;
}

</style>
</head>
<body>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script>
  var width = 300;
  var height = 300;
  
  d3.json('mn-county-2010/geojson-dp-60/mn-county-2010.json', function(error, counties) {
    // Bounding code borrowed from: http://www.larsko.org/v/igdp/
    var margin = width * 0.02;
    var proj = d3.geo.mercator().scale(1).translate([0,0]);
    var bounds0 = d3.geo.bounds(counties);
    var bounds = bounds0.map(proj);
    var xscale = (width - 2 * margin) / Math.abs(bounds[1][0] - bounds[0][0]);
    var yscale = (height - 2 * margin) / Math.abs(bounds[1][1] - bounds[0][1]);
    var pscale = Math.min(xscale, yscale);
    
    // Create svg canvas
    var svg = d3.select('body').append('svg')
      .attr('width', width)
      .attr('height', height)
      .attr('class', 'container');
    
    // Handle projection
    var wscale = pscale;
    proj.scale(pscale);
    proj.translate(proj([-bounds0[0][0], -bounds0[1][1]]));
    var path = d3.geo.path().projection(proj);
    
    // Handle svg canvas, dpeneding on orientation
    if (xscale > yscale) {
      var d = xscale * Math.abs(bounds[1][0] - bounds[0][0]) - yscale * Math.abs(bounds[1][0] - bounds[0][0]);
      svg.attr('transform', 'translate(' + d / 2 + ', 0)');
    }
    else {
      var d = yscale * Math.abs(bounds[1][1] - bounds[0][1]) - xscale * Math.abs(bounds[1][1] - bounds[0][1]);
      svg.attr('transform', 'translate(0, ' + d / 5 + ')');
    }
    
    // Handle offset, dpeneding on orientation
    var widthd = proj(bounds0[0])[1];
    var heightd = proj(bounds0[1])[0];
    if (xscale > yscale) {
      var offsetxd = (width / 2 - widthd / 2);
      var offsetyd = margin;
    }
    else {
      var offsetxd = margin;
      var offsetyd = (height / 2 - heightd / 2);
    }
  
    // Render paths
    svg.append('svg')
      .attr('class', 'tracts')
    .selectAll('path')
      .data(counties.features)
    .enter().append('svg:path')
      .attr('d', path)
      .attr('stroke', '#EDEDED')
      .attr('transform', 'translate(' + offsetxd + ', ' + offsetyd + ')');
  });
</script>
</body>
</html>